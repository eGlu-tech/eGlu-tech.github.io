---
import { getCollection } from 'astro:content';
import '../../styles/global.css';
import '../../styles/index.css';
import './author.css';
import { blogName } from '../../constants.ts';
import Footer from '../../components/footer/Footer.astro';
import BaseHead from '../../components/base-head/BaseHead.astro';

export async function getStaticPaths() {
  const authors = await getCollection('author');
  return authors.map(author => ({
    params: { slug: author.id },
    props: { author },
  }));
}

const { author } = Astro.props;
const { Content } = await author.render();
const { name, github } = author.data;
const handle = author.id.split('/').pop()?.split('.')[0] || author.id;
---

<html lang="en">
	<BaseHead title={`${name} | ${blogName}`} />
	<body>
		<div class="container">
			<main>
				<header style="margin-bottom: 1rem;">
					<a href="/" class="brand-link">
						<h1>{blogName}</h1>
					</a>
				</header>

				<section class="author-profile">
					<div class="author-header">
						<h2 class="author-name">{name}</h2>
						<div class="author-meta">
							<a href={Astro.url.pathname} class="author-handle">@{handle}</a>
							<span class="meta-separator">/</span>
							<div class="author-links">
								<a href={github} class="github-link" target="_blank" rel="noopener noreferrer" aria-label="GitHub Profile">
									<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="18" height="18"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg>
								</a>
							</div>
						</div>
					</div>
					<div class="author-bio prose">
						<Content />
					</div>
				</section>
			</main>

			<Footer />
		</div>
	</body>
</html>
